// Weekly Payslip Generator Web App (Offline, Browser-Based) // Dependencies: jsPDF, JSZip

<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weekly Payslip Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
<h1>Weekly Payslip Generator (1 Year)</h1>
<form id="payslipForm">
  <h2>Company Details</h2>
  Company Name: <input type="text" id="companyName" required><br>
  ABN: <input type="text" id="abn" required><br>
  Address: <input type="text" id="address" required><br>
  Super Rate (%): <input type="number" id="superRate" value="11" required><br>  <h2>Employee Details</h2>
  Employee Name: <input type="text" id="empName" required><br>
  Employee ID: <input type="text" id="empID" required><br>
  Hourly Rate ($): <input type="number" id="hourlyRate" step="0.01" required><br>
  Weekly Hours: <input type="number" id="hoursWorked" step="0.1" required><br>
  Overtime Hours: <input type="number" id="overtimeHours" value="0" step="0.1"><br>
  Overtime Rate: <input type="number" id="overtimeRate" value="0" step="0.01"><br>
  Leave Balances (Annual, Sick): <input type="text" id="leaveBalances" value="0,0"><br>Pay Period Start Date (Tuesday): <input type="date" id="startDate" required><br>

<button type="submit">Generate Payslips</button>

</form><script>
document.getElementById('payslipForm').addEventListener('submit', async function(e) {
  e.preventDefault();

  const { jsPDF } = window.jspdf;
  const zip = new JSZip();

  // Get Inputs
  const companyName = document.getElementById('companyName').value;
  const abn = document.getElementById('abn').value;
  const address = document.getElementById('address').value;
  const superRate = parseFloat(document.getElementById('superRate').value) / 100;

  const empName = document.getElementById('empName').value;
  const empID = document.getElementById('empID').value;
  const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
  const hoursWorked = parseFloat(document.getElementById('hoursWorked').value);
  const overtimeHours = parseFloat(document.getElementById('overtimeHours').value);
  const overtimeRate = parseFloat(document.getElementById('overtimeRate').value);

  let [annualLeave, sickLeave] = document.getElementById('leaveBalances').value.split(',').map(Number);

  let startDate = new Date(document.getElementById('startDate').value);

  for(let week=1; week<=52; week++){
    const endDate = new Date(startDate);
    endDate.setDate(startDate.getDate() + 6); // Tuesday-to-Tuesday period

    // Calculations
    const gross = (hoursWorked * hourlyRate) + (overtimeHours * overtimeRate);
    const superAmount = gross * superRate;
    const payg = calculateWeeklyPAYG(gross);
    const netPay = gross - superAmount - payg;

    // Leave accruals
    annualLeave += gross * 0.0154; // weekly accrual approx 4 weeks/year
    sickLeave += gross * 0.0385/12; // 10 days/year approx

    // Generate PDF
    const doc = new jsPDF();
    doc.setFontSize(12);
    doc.text(`EMPLOYEE PAYSLIP`, 20, 20);
    doc.text(`Company: ${companyName}`, 20, 30);
    doc.text(`ABN: ${abn}`, 20, 36);
    doc.text(`Address: ${address}`, 20, 42);
    doc.text(`Employee: ${empName} (ID: ${empID})`, 20, 54);
    doc.text(`Pay Period: ${startDate.toLocaleDateString()} - ${endDate.toLocaleDateString()}`, 20, 60);

    doc.text(`Hours Worked: ${hoursWorked}`, 20, 72);
    doc.text(`Hourly Rate: $${hourlyRate.toFixed(2)}`, 20, 78);
    doc.text(`Overtime: ${overtimeHours} @ $${overtimeRate.toFixed(2)}`, 20, 84);
    doc.text(`Gross Pay: $${gross.toFixed(2)}`, 20, 96);
    doc.text(`PAYG: $${payg.toFixed(2)}`, 20, 102);
    doc.text(`Super (${(superRate*100).toFixed(1)}%): $${superAmount.toFixed(2)}`, 20, 108);
    doc.text(`Net Pay: $${netPay.toFixed(2)}`, 20, 114);

    doc.text(`Annual Leave Balance: $${annualLeave.toFixed(2)}`, 20, 126);
    doc.text(`Sick Leave Balance: $${sickLeave.toFixed(2)}`, 20, 132);

    // Add PDF to ZIP
    const pdfBlob = doc.output('blob');
    zip.file(`Payslip_Week${week}.pdf`, pdfBlob);

    // Next week
    startDate.setDate(startDate.getDate() + 7);
  }

  // Generate ZIP and download
  const zipBlob = await zip.generateAsync({type:'blob'});
  const url = URL.createObjectURL(zipBlob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `${empName}_Payslips_Year.zip`;
  a.click();
  URL.revokeObjectURL(url);

  alert('52 weekly payslips generated and downloaded as ZIP!');
});

// Approximate weekly PAYG calculation for simplicity
function calculateWeeklyPAYG(gross){
  const annualised = gross * 52;
  let tax = 0;
  if(annualised <= 18200) tax = 0;
  else if(annualised <= 45000) tax = (annualised-18200)*0.19;
  else if(annualised <= 120000) tax = 5092+(annualised-45000)*0.325;
  else if(annualised <= 180000) tax = 29467+(annualised-120000)*0.37;
  else tax = 51667+(annualised-180000)*0.45;
  return tax/52; // weekly PAYG
}
</script></body>
</html>
